services:
  blup:
    # https://docs.celeryq.dev/en/stable/reference/cli.html#celery-worker
    command: |
      docker run -v mydata:/tmp/results/fritz/ -i alpine touch /tmp/results/fritz/nix
    build:
      context: .
      dockerfile: Dockerfile
    #    privileged: true
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
  blup2:
    # https://docs.celeryq.dev/en/stable/reference/cli.html#celery-worker
    command: |
      docker run -v mydata:/tmp/results/fritz/ -i alpine find /tmp/results/fritz
    build:
      context: .
      dockerfile: Dockerfile
    #    privileged: true
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
    depends_on:
      blup:
        condition: service_completed_successfully


volumes:
  mydata:
